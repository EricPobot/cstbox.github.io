

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>evtdb - CSTBox Events Database access D-Bus service &mdash; CSTBox 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="CSTBox 1.0 documentation" href="../index.html"/>
        <link rel="up" title="Extensions" href="../extensions.html"/>
        <link rel="next" title="mqtt - MQTT gateway extension" href="mqtt.html"/>
        <link rel="prev" title="webui - CSTBox Web based user interface" href="webui.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> CSTBox
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">CSTBox API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../core.html">Core system</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../core/cfgbroker.html">cfgbroker - Device network configuration access service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/cli.html">cli - Command line interface helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/config.html">config - System wide configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/cron.html">cron - CSTBox crontab management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/dbuslib.html">dbuslib - D-Bus helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/devcfg.html">devcfg - Devices network configuration data access tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/events.html">events - Basic definitions and tools related to CSTBox events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/evtmgr.html">evtmgr - CSTBox Event manager service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/export.html">export - Events data export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/flags.html">flags - Notification flags management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/hal.html">hal - Hardware Abstraction Layer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/hal.html#sub-package-content">Sub-package content</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/log.html">log - Customized logging system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/service.html">service - Fundation classes for services implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/statemgr.html">statemgr - State variables management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/statemgr.html#module-pycstbox.statemgr.core">statemgr.core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/statemgr.html#module-pycstbox.statemgr.mgr">statemgr.mgr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/statemgr.html#module-pycstbox.statemgr.dbus_binding">statemgr.dbus_binding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/sysutils.html">sysutils - CSTBox system level utilities</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../extensions.html">Extensions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../extensions.html#devices-support-extensions">Devices support extensions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extensions.html#protocol-enablers">Protocol enablers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extensions.html#products-drivers">Products drivers</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="../extensions.html#optional-services">Optional services</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="webui.html">webui - CSTBox Web based user interface</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="">evtdb - CSTBox Events Database access D-Bus service</a></li>
<li class="toctree-l4"><a class="reference internal" href="mqtt.html">mqtt - MQTT gateway extension</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">CSTBox</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../api.html">CSTBox API documentation</a> &raquo;</li>
      
          <li><a href="../extensions.html">Extensions</a> &raquo;</li>
      
    <li>evtdb - CSTBox Events Database access D-Bus service</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="module-pycstbox.evtdb">
<span id="evtdb-cstbox-events-database-access-d-bus-service"></span><h1>evtdb - CSTBox Events Database access D-Bus service<a class="headerlink" href="#module-pycstbox.evtdb" title="Permalink to this headline">¶</a></h1>
<p>CSTBox Events Database access D-Bus service.</p>
<p>The class defined in this module do not implement the data access layer, but
sits on top of it to provide a generic API for data storage and retrieval.</p>
<p>The data access layer is defined in separate DAO classes, which can be viewed
as drivers for supported persistence mechanism. This approach allows switching
between different underlying storage strategies, without any impact for the
upper layers.</p>
<p>The concrete DAO to be used must be passed to the constructor.</p>
<dl class="class">
<dt id="pycstbox.evtdb.EventsDatabase">
<em class="property">class </em><code class="descclassname">pycstbox.evtdb.</code><code class="descname">EventsDatabase</code><span class="sig-paren">(</span><em>conn</em>, <em>daos</em><span class="sig-paren">)</span><a class="headerlink" href="#pycstbox.evtdb.EventsDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p>CSTBox Event database service.</p>
<p>This container will host a service object for each event channel, in order
to keep the various communication separated, and this easing the subscription
to a given kind of channel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conn</strong> &#8211; the D-Bus connection (Session, System,...)</li>
<li><strong>daos</strong> &#8211; a list of tuples, containing the channel name and the DAO instance managing
its events</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="pycstbox.evtdb.EventDatabaseObject">
<em class="property">class </em><code class="descclassname">pycstbox.evtdb.</code><code class="descname">EventDatabaseObject</code><span class="sig-paren">(</span><em>channel</em>, <em>dao</em><span class="sig-paren">)</span><a class="headerlink" href="#pycstbox.evtdb.EventDatabaseObject" title="Permalink to this definition">¶</a></dt>
<dd><p>The service object for a given event database.</p>
<p>One instance of this class is created for managing the persistence of
each event channel to be managed (see EventDatabase.__init__().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>channel</strong> (<em>str</em>) &#8211; the event channel</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pycstbox.evtdb.EventDatabaseObject.start">
<code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pycstbox.evtdb.EventDatabaseObject.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Service objet runtime initialization</p>
</dd></dl>

<dl class="method">
<dt id="pycstbox.evtdb.EventDatabaseObject.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pycstbox.evtdb.EventDatabaseObject.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup before stop</p>
</dd></dl>

<dl class="method">
<dt id="pycstbox.evtdb.EventDatabaseObject.get_available_days">
<code class="descname">get_available_days</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pycstbox.evtdb.EventDatabaseObject.get_available_days" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of days for which events have been stored.</p>
<p>The result is an array of dates formatted as &#8220;YYYY-MM-DD&#8221;</p>
</dd></dl>

<dl class="method">
<dt id="pycstbox.evtdb.EventDatabaseObject.get_events_for_day">
<code class="descname">get_events_for_day</code><span class="sig-paren">(</span><em>day</em>, <em>var_type=None</em>, <em>var_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pycstbox.evtdb.EventDatabaseObject.get_events_for_day" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of events matching the provided criteria.</p>
<p>The result is an array of tuples representing the properties of the
events (timestamp, var_type, var_name, value, dictionary of additional
infos).</p>
<p>Events are returned in D-Bus compatible format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>day</strong> (<em>str</em>) &#8211; the date of the requested days (as a valid SQL date)</li>
<li><strong>var_type</strong> (<em>str</em>) &#8211; (optional) an event class (&#8216;temperature&#8217;,...) for filtering the returned list</li>
<li><strong>var_name</strong> (<em>str</em>) &#8211; (optional) the var_name of events for filtering the returned list</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a list of events, as serializable tuples</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycstbox.evtdb.EventDatabaseObject.get_events">
<code class="descname">get_events</code><span class="sig-paren">(</span><em>event_filter</em><span class="sig-paren">)</span><a class="headerlink" href="#pycstbox.evtdb.EventDatabaseObject.get_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of events matching the provided filter.</p>
<p>Events are returned in D-Bus compatible format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>event_filter</strong> (<em>dict</em>) &#8211; DAOs get_events() method keyword parameters  as a dictonary</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a list of events, as serializable tuples</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pycstbox.evtdb.get_object">
<code class="descclassname">pycstbox.evtdb.</code><code class="descname">get_object</code><span class="sig-paren">(</span><em>channel</em><span class="sig-paren">)</span><a class="headerlink" href="#pycstbox.evtdb.get_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the service proxy object for a given event channel if available</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>channel</strong> (<em>str</em>) &#8211; the event channel managed by the requested service instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the requested service instance, if exists</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Raises ValueError:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">if no bus name match the requested channel</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mqtt.html" class="btn btn-neutral float-right" title="mqtt - MQTT gateway extension" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="webui.html" class="btn btn-neutral" title="webui - CSTBox Web based user interface" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>